---
- name: Reset AD User Password
hosts: localhost
connection: local
gather_facts: no


vars_prompt:
- name: target_user
prompt: "Digite o username do AD a resetar"
private: no


- name: new_password
prompt: "Digite a nova senha"
private: yes


tasks:
- name: Reset password for user {{ target_user }}
microsoft.ad.user:
server: "{{ ad_server }}"
domain: "{{ ad_domain }}"
domain_username: "{{ ad_username }}"
domain_password: "{{ ad_password }}"
name: "{{ target_user }}"
password: "{{ new_password }}"
update_password: always
state: present
register: reset_result


- name: Mostrar resultado
debug:
msg: "Senha resetada com sucesso para o usu√°rio {{ target_user }}"
