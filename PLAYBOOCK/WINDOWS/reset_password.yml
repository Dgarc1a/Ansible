---
- name: Reset AD User Password
  hosts: windows
  gather_facts: no

  vars_prompt:
    - name: target_user
      prompt: "Digite o username do AD a resetar"
      private: no

    - name: new_password
      prompt: "Digite a nova senha"
      private: yes

  tasks:

    - name: "Reset password for user {{ target_user }}"
      microsoft.ad.user:
        name: "{{ target_user }}"
        password: "{{ new_password }}"
        update_password: always
        state: present
      register: reset_result

    - name: Mostrar resultado
      debug:
        msg: "Senha resetada com sucesso para o usu√°rio {{ target_user }}"
